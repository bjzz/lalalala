//
//  SECNamedCurves.m
//  crypto
//
//  Created by JGehry on 6/16/16.
//  Copyright (c) 2016 pallas. All rights reserved.
//

#import "SECNamedCurves.h"
#import "SECObjectIdentifiers.h"
#import "Hex.h"
#import "GlvTypeBEndomorphism.h"

@implementation SECNamedCurves

+ (X9ECParametersHolder *)secp112r1 {
    static X9ECParametersHolder *_secp112r1 = nil;
    @synchronized(self) {
        if (!_secp112r1) {
            _secp112r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp112r1;
}

+ (X9ECParametersHolder *)secp112r2 {
    static X9ECParametersHolder *_secp112r2 = nil;
    @synchronized(self) {
        if (!_secp112r2) {
            _secp112r2 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp112r2;
}

+ (X9ECParametersHolder *)secp128r1 {
    static X9ECParametersHolder *_secp128r1 = nil;
    @synchronized(self) {
        if (!_secp128r1) {
            _secp128r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp128r1;
}

+ (X9ECParametersHolder *)secp128r2 {
    static X9ECParametersHolder *_secp128r2 = nil;
    @synchronized(self) {
        if (!_secp128r2) {
            _secp128r2 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp128r2;
}

+ (X9ECParametersHolder *)secp160k1 {
    static X9ECParametersHolder *_secp160k1 = nil;
    @synchronized(self) {
        if (!_secp160k1) {
            _secp160k1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp160k1;
}

+ (X9ECParametersHolder *)secp160r1 {
    static X9ECParametersHolder *_secp160r1 = nil;
    @synchronized(self) {
        if (!_secp160r1) {
            _secp160r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp160r1;
}

+ (X9ECParametersHolder *)secp160r2 {
    static X9ECParametersHolder *_secp160r2 = nil;
    @synchronized(self) {
        if (!_secp160r2) {
            _secp160r2 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp160r2;
}

+ (X9ECParametersHolder *)secp192k1 {
    static X9ECParametersHolder *_secp192k1 = nil;
    @synchronized(self) {
        if (!_secp192k1) {
            _secp192k1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp192k1;
}

+ (X9ECParametersHolder *)secp192r1 {
    static X9ECParametersHolder *_secp192r1 = nil;
    @synchronized(self) {
        if (!_secp192r1) {
            _secp192r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp192r1;
}

+ (X9ECParametersHolder *)secp224k1 {
    static X9ECParametersHolder *_secp224k1 = nil;
    @synchronized(self) {
        if (!_secp224k1) {
            _secp224k1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp224k1;
}

+ (X9ECParametersHolder *)secp224r1 {
    static X9ECParametersHolder *_secp224r1 = nil;
    @synchronized(self) {
        if (!_secp224r1) {
            _secp224r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp224r1;
}

+ (X9ECParametersHolder *)secp256k1 {
    static X9ECParametersHolder *_secp256k1 = nil;
    @synchronized(self) {
        if (!_secp256k1) {
            _secp256k1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp256k1;
}

+ (X9ECParametersHolder *)secp256r1 {
    static X9ECParametersHolder *_secp256r1 = nil;
    @synchronized(self) {
        if (!_secp256r1) {
            _secp256r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp256r1;
}

+ (X9ECParametersHolder *)secp384r1 {
    static X9ECParametersHolder *_secp384r1 = nil;
    @synchronized(self) {
        if (!_secp384r1) {
            _secp384r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp384r1;
}

+ (X9ECParametersHolder *)secp521r1 {
    static X9ECParametersHolder *_secp521r1 = nil;
    @synchronized(self) {
        if (!_secp521r1) {
            _secp521r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _secp521r1;
}

+ (X9ECParametersHolder *)sect113r1 {
    static X9ECParametersHolder *_sect113r1 = nil;
    @synchronized(self) {
        if (!_sect113r1) {
            _sect113r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect113r1;
}

+ (X9ECParametersHolder *)sect113r2 {
    static X9ECParametersHolder *_sect113r2 = nil;
    @synchronized(self) {
        if (!_sect113r2) {
            _sect113r2 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect113r2;
}

+ (X9ECParametersHolder *)sect131r1 {
    static X9ECParametersHolder *_sect131r1 = nil;
    @synchronized(self) {
        if (!_sect131r1) {
            _sect131r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect131r1;
}

+ (X9ECParametersHolder *)sect131r2 {
    static X9ECParametersHolder *_sect131r2 = nil;
    @synchronized(self) {
        if (!_sect131r2) {
            _sect131r2 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect131r2;
}

+ (X9ECParametersHolder *)sect163k1 {
    static X9ECParametersHolder *_sect163k1 = nil;
    @synchronized(self) {
        if (!_sect163k1) {
            _sect163k1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect163k1;
}

+ (X9ECParametersHolder *)sect163r1 {
    static X9ECParametersHolder *_sect163r1 = nil;
    @synchronized(self) {
        if (!_sect163r1) {
            _sect163r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect163r1;
}

+ (X9ECParametersHolder *)sect163r2 {
    static X9ECParametersHolder *_sect163r2 = nil;
    @synchronized(self) {
        if (!_sect163r2) {
            _sect163r2 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect163r2;
}

+ (X9ECParametersHolder *)sect193r1 {
    static X9ECParametersHolder *_sect193r1 = nil;
    @synchronized(self) {
        if (!_sect193r1) {
            _sect193r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect193r1;
}

+ (X9ECParametersHolder *)sect193r2 {
    static X9ECParametersHolder *_sect193r2 = nil;
    @synchronized(self) {
        if (!_sect193r2) {
            _sect193r2 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect193r2;
}

+ (X9ECParametersHolder *)sect233k1 {
    static X9ECParametersHolder *_sect233k1 = nil;
    @synchronized(self) {
        if (!_sect233k1) {
            _sect233k1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect233k1;
}

+ (X9ECParametersHolder *)sect233r1 {
    static X9ECParametersHolder *_sect233r1 = nil;
    @synchronized(self) {
        if (!_sect233r1) {
            _sect233r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect233r1;
}

+ (X9ECParametersHolder *)sect239k1 {
    static X9ECParametersHolder *_sect239k1 = nil;
    @synchronized(self) {
        if (!_sect239k1) {
            _sect239k1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect239k1;
}

+ (X9ECParametersHolder *)sect283k1 {
    static X9ECParametersHolder *_sect283k1 = nil;
    @synchronized(self) {
        if (!_sect283k1) {
            _sect283k1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect283k1;
}

+ (X9ECParametersHolder *)sect283r1 {
    static X9ECParametersHolder *_sect283r1 = nil;
    @synchronized(self) {
        if (!_sect283r1) {
            _sect283r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect283r1;
}

+ (X9ECParametersHolder *)sect409k1 {
    static X9ECParametersHolder *_sect409k1 = nil;
    @synchronized(self) {
        if (!_sect409k1) {
            _sect409k1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect409k1;
}

+ (X9ECParametersHolder *)sect409r1 {
    static X9ECParametersHolder *_sect409r1 = nil;
    @synchronized(self) {
        if (!_sect409r1) {
            _sect409r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect409r1;
}

+ (X9ECParametersHolder *)sect571k1 {
    static X9ECParametersHolder *_sect571k1 = nil;
    @synchronized(self) {
        if (!_sect571k1) {
            _sect571k1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect571k1;
}

+ (X9ECParametersHolder *)sect571r1 {
    static X9ECParametersHolder *_sect571r1 = nil;
    @synchronized(self) {
        if (!_sect571r1) {
            _sect571r1 = [[X9ECParametersHolder alloc] init];
        }
    }
    return _sect571r1;
}

+ (NSMutableDictionary *)objIds {
    static NSMutableDictionary *_objIds = nil;
    @synchronized(self) {
        if (!_objIds) {
            _objIds = [[NSMutableDictionary alloc] init];
        }
    }
    return _objIds;
}

+ (NSMutableDictionary *)curves {
    static NSMutableDictionary *_curves = nil;
    @synchronized(self) {
        if (!_curves) {
            _curves = [[NSMutableDictionary alloc] init];
        }
    }
    return _curves;
}

+ (NSMutableDictionary *)names {
    static NSMutableDictionary *_names = nil;
    @synchronized(self) {
        if (!_names) {
            _names = [[NSMutableDictionary alloc] init];
        }
    }
    return _names;
}

+ (ECCurve *)configureCurve:(ECCurve *)paramECCurve {
    return paramECCurve;
}

+ (ECCurve *)configureCurve:(ECCurve *)paramECCurve paramGLVTypeBParameters:(GlvTypeBParameters *)paramGLVTypeBParameters {
    ECEndomorphism *endom = [[GlvTypeBEndomorphism alloc] initWithCurve:paramECCurve withParameters:paramGLVTypeBParameters];
    Config *config = [[paramECCurve configure] setEndomorphismWithEndomorphism:endom];
#if !__has_feature(objc_arc)
    if (endom) [endom release]; endom = nil;
#endif
    return [config create];
}

+ (BigInteger *)fromHex:(NSString *)paramString {
    BigInteger *retVal = nil;
    @autoreleasepool {
        NSMutableData *data = [Hex decodeWithString:paramString];
        retVal = [[BigInteger alloc] initWithSign:1 withBytes:data];
    }
    return (retVal ? [retVal autorelease] : nil);
}

+ (void)defineCurve:(NSString *)paramString paramASN1ObjectIdentifier:(ASN1ObjectIdentifier *)paramASN1ObjectIdentifier paramX9ECParametersHolder:(X9ECParametersHolder *)paramX9ECParametersHolder {
    [[self objIds] setObject:paramASN1ObjectIdentifier forKey:[paramString lowercaseString]];
    [[self names] setObject:paramString forKey:paramASN1ObjectIdentifier];
    [[self curves] setObject:paramX9ECParametersHolder forKey:paramASN1ObjectIdentifier];
}

+ (X9ECParameters *)getByName:(NSString *)paramString {
    ASN1ObjectIdentifier *localASN1ObjectIdentifier = [self getOID:paramString];
    return localASN1ObjectIdentifier == nil ? nil : [self getByOID:localASN1ObjectIdentifier paramString:paramString];
}

+ (X9ECParameters *)getByOID:(ASN1ObjectIdentifier *)paramASN1ObjectIdentifier paramString:(NSString *)paramString {
    X9ECParametersHolder *localX9ECParametersHolder = (X9ECParametersHolder *)[[self curves] objectForKey:paramASN1ObjectIdentifier];
    return localX9ECParametersHolder == nil ? nil : [localX9ECParametersHolder getParameters:paramString];
}

+ (ASN1ObjectIdentifier *)getOID:(NSString *)paramString {
    return (ASN1ObjectIdentifier *)[[self objIds] objectForKey:[paramString lowercaseString]];
}

+ (NSString *)getName:(ASN1ObjectIdentifier *)paramASN1ObjectIdentifier {
    return (NSString *)[[self names] objectForKey:paramASN1ObjectIdentifier];
}

+ (NSEnumerator *)getNames {
    return [[self names] objectEnumerator];
}

+ (void)load {
    [super load];
    [self defineCurve:@"secp112r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp112r1] paramX9ECParametersHolder:[self secp112r1]];
    [self defineCurve:@"secp112r2" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp112r2] paramX9ECParametersHolder:[self secp112r2]];
    [self defineCurve:@"secp128r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp128r1] paramX9ECParametersHolder:[self secp128r1]];
    [self defineCurve:@"secp128r2" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp128r2] paramX9ECParametersHolder:[self secp128r2]];
    [self defineCurve:@"secp160k1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp160k1] paramX9ECParametersHolder:[self secp160k1]];
    [self defineCurve:@"secp160r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp160r1] paramX9ECParametersHolder:[self secp160r1]];
    [self defineCurve:@"secp160r2" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp160r2] paramX9ECParametersHolder:[self secp160r2]];
    [self defineCurve:@"secp192k1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp192k1] paramX9ECParametersHolder:[self secp192k1]];
    [self defineCurve:@"secp192r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp192r1] paramX9ECParametersHolder:[self secp192r1]];
    [self defineCurve:@"secp224k1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp224k1] paramX9ECParametersHolder:[self secp224k1]];
    [self defineCurve:@"secp224r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp224r1] paramX9ECParametersHolder:[self secp224r1]];
    [self defineCurve:@"secp256k1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp256k1] paramX9ECParametersHolder:[self secp256k1]];
    [self defineCurve:@"secp256r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp256r1] paramX9ECParametersHolder:[self secp256r1]];
    [self defineCurve:@"secp384r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp384r1] paramX9ECParametersHolder:[self secp384r1]];
    [self defineCurve:@"secp521r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers secp521r1] paramX9ECParametersHolder:[self secp521r1]];
    [self defineCurve:@"sect113r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect113r1] paramX9ECParametersHolder:[self sect113r1]];
    [self defineCurve:@"sect113r2" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect113r2] paramX9ECParametersHolder:[self sect113r2]];
    [self defineCurve:@"sect131r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect131r1] paramX9ECParametersHolder:[self sect131r1]];
    [self defineCurve:@"sect131r2" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect131r2] paramX9ECParametersHolder:[self sect131r2]];
    [self defineCurve:@"sect163k1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect163k1] paramX9ECParametersHolder:[self sect163k1]];
    [self defineCurve:@"sect163r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect163r1] paramX9ECParametersHolder:[self sect163r1]];
    [self defineCurve:@"sect163r2" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect163r2] paramX9ECParametersHolder:[self sect163r2]];
    [self defineCurve:@"sect193r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect193r1] paramX9ECParametersHolder:[self sect193r1]];
    [self defineCurve:@"sect193r2" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect193r2] paramX9ECParametersHolder:[self sect193r2]];
    [self defineCurve:@"sect233k1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect233k1] paramX9ECParametersHolder:[self sect233k1]];
    [self defineCurve:@"sect233r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect233r1] paramX9ECParametersHolder:[self sect233r1]];
    [self defineCurve:@"sect239k1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect239k1] paramX9ECParametersHolder:[self sect239k1]];
    [self defineCurve:@"sect283k1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect283k1] paramX9ECParametersHolder:[self sect283k1]];
    [self defineCurve:@"sect283r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect283r1] paramX9ECParametersHolder:[self sect283r1]];
    [self defineCurve:@"sect409k1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect409k1] paramX9ECParametersHolder:[self sect409k1]];
    [self defineCurve:@"sect409r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect409r1] paramX9ECParametersHolder:[self sect409r1]];
    [self defineCurve:@"sect571k1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect571k1] paramX9ECParametersHolder:[self sect571k1]];
    [self defineCurve:@"sect571r1" paramASN1ObjectIdentifier:[SECObjectIdentifiers sect571r1] paramX9ECParametersHolder:[self sect571r1]];
}

@end
